<!DOCTYPE html>
<html>
<head>
  <title>D3 Canvas Template</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Basic styling for the container */
    .chart-container {
      width: 100%;
      max-width: 800px; /* Example max width */
      margin: auto;
      border: 1px solid #ccc; /* For visualization */
      position: relative; /* Needed if overlaying SVG for axes */
    }
    canvas {
      display: block; /* Remove extra space below canvas */
      width: 100%;
      height: auto; /* Maintain aspect ratio based on initial setup */
      background-color: #f9f9f9; /* Example background */
    }
    /* Optional: Style for an overlay SVG (e.g., for axes) */
    .overlay-svg {
        position: absolute;
        top: 0;
        left: 0;
        pointer-events: none; /* Allow interaction with canvas below */
    }
  </style>
</head>
<body>

<div id="chart-container" class="chart-container">
  <canvas id="main-canvas"></canvas>
  {/* Optional: SVG overlay for axes/labels */}
  {/* <svg class="overlay-svg"></svg> */}
</div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
  // --- D3 Code ---

  // 1. Select container and define dimensions
  const container = d3.select("#chart-container");
  const containerWidth = container.node().getBoundingClientRect().width;

  const margin = { top: 20, right: 30, bottom: 40, left: 50 };
  const width = containerWidth - margin.left - margin.right;
  const aspectRatio = 0.6;
  const height = width * aspectRatio;

  // --- Canvas Setup ---
  const canvas = d3.select("#main-canvas")
      .attr('width', width + margin.left + margin.right)
      .attr('height', height + margin.top + margin.bottom);

  // Get 2D rendering context
  const context = canvas.node().getContext('2d');

  // Adjust for margins by translating the context
  context.translate(margin.left, margin.top);

  // --- Your D3 Canvas drawing logic goes here ---

  // Example: Scales (adjust domain based on your data)
  const xScale = d3.scaleLinear().domain([0, 100]).range([0, width]);
  const yScale = d3.scaleLinear().domain([0, 100]).range([height, 0]); // Note: Canvas Y is often top-down

  // Example: Drawing a rectangle
  context.fillStyle = 'lightblue';
  context.fillRect(0, 0, width, height); // x, y, width, height

  // Example: Drawing circles based on data
  const myData = [{x: 10, y: 20}, {x: 50, y: 80}, {x: 80, y: 50}];

  context.fillStyle = 'steelblue';
  myData.forEach(d => {
    context.beginPath(); // Start a new path for each circle
    context.arc(xScale(d.x), yScale(d.y), 5, 0, 2 * Math.PI); // cx, cy, radius, startAngle, endAngle
    context.fill(); // Fill the circle
    // context.stroke(); // Or stroke it
  });

  // --- Axes (Often drawn on an overlay SVG or manually on Canvas) ---
  // Manual Canvas Axis Example (Simplified):
  // Draw X axis line
  context.beginPath();
  context.moveTo(0, height);
  context.lineTo(width, height);
  context.strokeStyle = '#333';
  context.stroke();
  // Draw Y axis line
  context.beginPath();
  context.moveTo(0, 0);
  context.lineTo(0, height);
  context.stroke();
  // Draw ticks and labels (more complex)
  context.fillStyle = '#555';
  context.font = '10px sans-serif';
  context.textAlign = 'center';
  xScale.ticks(5).forEach(tickValue => {
      context.beginPath();
      context.moveTo(xScale(tickValue), height);
      context.lineTo(xScale(tickValue), height + 6); // Tick mark
      context.stroke();
      context.fillText(tickValue, xScale(tickValue), height + 16); // Tick label
  });
  // ... similar logic for Y axis ticks/labels ...


  // --- End D3 Canvas logic ---

  // Note: For interactions on Canvas (tooltips, hover), you need to:
  // 1. Listen for mouse events on the canvas element.
  // 2. Calculate mouse coordinates relative to the canvas.
  // 3. Invert scales (if needed) to find data coordinates.
  // 4. Implement hit detection logic (e.g., check if mouse is within a shape's bounds).
  // 5. Redraw or display tooltip based on hit detection.

</script>

</body>
</html>